{% extends "base.html" %}
{% block title %}–û—Ç—á—ë—Ç—ã{% endblock %}

{% block content %}
<h1>–û—Ç—á—ë—Ç—ã</h1>

{% set report_type = request.args.get('type', '') %}
{% set selected_parking = request.args.get('parking_id') %}
{% set start = request.args.get('start') %}
{% set end = request.args.get('end') %}

<div class="reports">

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <nav class="reports-nav">
    <ul>
      <li>
        <a href="{{ url_for('reports.view', type='payments') }}"
           class="{{ 'active' if report_type == 'payments' else '' }}">
          üí∞ –û—Ç—á—ë—Ç –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º
        </a>
      </li>

      <li>
        <a href="{{ url_for('reports.view', type='charges') }}"
           class="{{ 'active' if report_type == 'charges' else '' }}">
          üìÑ –û—Ç—á—ë—Ç –ø–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º
        </a>
      </li>

      <li>
        <a href="{{ url_for('reports.view', type='finance') }}"
           class="{{ 'active' if report_type == 'finance' else '' }}">
          üìä –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç
        </a>
      </li>
    </ul>
  </nav>

  <!-- –ï—Å–ª–∏ —Ç–∏–ø –æ—Ç—á—ë—Ç–∞ –≤—ã–±—Ä–∞–Ω ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä -->
  {% if report_type %}
  <form class="report-filter" method="GET" action="{{ url_for('reports.view') }}">
    <input type="hidden" name="type" value="{{ report_type }}">

    <div class="form-group">
      <label>–ü–µ—Ä–∏–æ–¥:</label>
      <input type="date" name="start" required value="{{ start or '' }}">
      <input type="date" name="end" required value="{{ end or '' }}">
    </div>

    <div class="form-group">
      <label>–ê–¥—Ä–µ—Å –ø–∞—Ä–∫–æ–≤–∫–∏:</label>
      <select name="parking_id">
        <option value="">–í—Å–µ –ø–∞—Ä–∫–æ–≤–∫–∏</option>

        {% for p in parkings %}
          <option value="{{ p.parking_id }}"
            {% if selected_parking == p.parking_id|string %}selected{% endif %}>
            {{ p.address }}
          </option>
        {% endfor %}
      </select>
    </div>

    <button class="btn green">–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç</button>
  </form>
  {% endif %}

  <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
  <div class="report-results">

    {% if report_type and start and end and report_data %}
      
      <table class="table">
        <thead>
          <tr>
            {% for col in report_data.columns %}
              <th>{{ col }}</th>
            {% endfor %}
          </tr>
        </thead>

        <tbody>
          {% for row in report_data.rows %}
            <tr>
              {% for cell in row %}
                <td>{{ cell }}</td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>

    {% elif report_type %}
      <p class="muted">–£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç¬ª.</p>

    {% else %}
      <p class="muted">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ—Ç—á—ë—Ç–∞, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.</p>
    {% endif %}
  </div>

</div>
{% endblock %}