{% extends "base.html" %}
{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∫–æ–≤–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ{% endblock %}

{% block content %}
<section class="form-section">
  <h1>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞ ‚Ññ{{ spot.number }}</h1>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-messages">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <form method="POST" action="{{ url_for('workspace.edit_spot', spot_id=spot.spot_id) }}" class="form-card">
    <div class="form-group">
      <label for="number">–ù–æ–º–µ—Ä –º–µ—Å—Ç–∞</label>
      <input type="text" id="number" name="number" class="form-control" value="{{ spot.number }}" required>
    </div>

    <div class="form-group">
      <label for="status">–°—Ç–∞—Ç—É—Å</label>
      <select id="status" name="status" required>
        <option value="—Å–≤–æ–±–æ–¥–Ω–æ" {% if spot.status == '—Å–≤–æ–±–æ–¥–Ω–æ' %}selected{% endif %}>—Å–≤–æ–±–æ–¥–Ω–æ</option>
        <option value="–∑–∞–Ω—è—Ç–æ" {% if spot.status == '–∑–∞–Ω—è—Ç–æ' %}selected{% endif %}>–∑–∞–Ω—è—Ç–æ</option>
        <option value="–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ" {% if spot.status == '–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ' %}selected{% endif %}>–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ</option>
      </select>
    </div>

    <div class="form-group">
      <label for="client_id">–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä</label>
      <select id="client_id" name="client_id">
        <option value="">‚Äî –ë–µ–∑ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–∞ ‚Äî</option>
        {% for client in clients %}
          <option value="{{ client.client_id }}"
            {% if active_booking and active_booking.client and active_booking.client.client_id == client.client_id %}
              selected
            {% endif %}>
            {{ client.name }} ({{ client.phone }})
          </option>
        {% endfor %}
      </select>
    </div>

    {% if active_booking and active_booking.client %}
      <div class="form-group">
        <p><strong>–¢–µ–∫—É—â–∏–π –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä:</strong> {{ active_booking.client.name }} ‚Äî {{ active_booking.client.phone }}</p>
        <p><strong>–ü–µ—Ä–∏–æ–¥:</strong>
          {{ active_booking.start_date.strftime('%Y-%m-%d') }} ‚Üí {{ active_booking.end_date.strftime('%Y-%m-%d') }}
        </p>
      </div>
    {% endif %}

    <div class="form-group">
      <label for="start_date">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∞—Ä–µ–Ω–¥—ã</label>
      <input type="date" id="start_date" name="start_date">
    </div>

    <div class="form-group">
      <label for="end_date">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞—Ä–µ–Ω–¥—ã</label>
      <input type="date" id="end_date" name="end_date">
    </div>

    <div class="buttons-container">
      <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
      <a href="{{ url_for('workspace.view') }}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
    </div>
  </form>
</section>
{% endblock %}